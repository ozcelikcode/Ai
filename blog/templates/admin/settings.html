{% extends "admin/base.html" %}

{% block page_title %}Site AyarlarÄ±{% endblock %}
{% block page_description %}Sitenizin genel ayarlarÄ±nÄ± yÃ¶netin{% endblock %}

{% block content %}
<form method="POST" action="/admin/settings/save" enctype="multipart/form-data">
    <div class="space-y-8">
        <!-- Site Genel AyarlarÄ± -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-lg font-semibold text-brown-900 mb-4 flex items-center">
                <i data-lucide="globe" class="w-5 h-5 mr-2"></i>
                Site Genel AyarlarÄ±
            </h3>
            
            <div>
                <label class="block text-brown-700 font-medium mb-2">Site BaÅŸlÄ±ÄŸÄ±</label>
                <input type="text" name="site_title" 
                       value="{{ settings.site_title if settings else 'AI Blog' }}" 
                       class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
            </div>
            
            <div class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                <div class="flex items-center">
                    <i data-lucide="info" class="w-5 h-5 text-blue-600 mr-2"></i>
                    <div>
                        <p class="text-blue-800 font-medium">Logo AyarlarÄ±</p>
                        <p class="text-blue-700 text-sm mt-1">
                            Logo ayarlarÄ±nÄ± yapmak iÃ§in 
                            <a href="/admin/customize" class="font-medium underline hover:no-underline">Site Ã–zelleÅŸtirme</a> 
                            sayfasÄ±nÄ± kullanÄ±n.
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="mt-4">
                <label class="block text-brown-700 font-medium mb-2">Site AÃ§Ä±klamasÄ±</label>
                <textarea name="meta_description" rows="3" 
                          placeholder="Sitenizin kÄ±sa aÃ§Ä±klamasÄ±"
                          class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">{{ settings.meta_description if settings else '' }}</textarea>
            </div>
            
            <div class="mt-4">
                <label class="block text-brown-700 font-medium mb-2">Anahtar Kelimeler</label>
                <input type="text" name="meta_keywords" 
                       value="{{ settings.meta_keywords if settings else '' }}" 
                       placeholder="blog, yapay zeka, teknoloji"
                       class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                <p class="text-sm text-brown-600 mt-1">VirgÃ¼lle ayÄ±rarak yazÄ±n</p>
            </div>
            
            <div class="mt-4">
                <label class="block text-brown-700 font-medium mb-2">Favicon URL</label>
                <input type="url" name="favicon" 
                       value="{{ settings.favicon if settings else '' }}" 
                       placeholder="https://example.com/favicon.ico"
                       class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
            </div>
        </div>

        <!-- Saat Dilimi AyarlarÄ± -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-lg font-semibold text-brown-900 mb-4 flex items-center">
                <i data-lucide="clock" class="w-5 h-5 mr-2"></i>
                Saat Dilimi AyarlarÄ±
            </h3>
            
            <div>
                <label class="block text-brown-700 font-medium mb-2">Saat Dilimi</label>
                <select name="timezone" id="timezone-select"
                        class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                    <option value="">Saat dilimi seÃ§in...</option>
                    
                    <!-- TÃ¼rkiye -->
                    <optgroup label="ðŸ‡¹ðŸ‡· TÃ¼rkiye">
                        <option value="Europe/Istanbul" {{ 'selected' if settings and settings.timezone == 'Europe/Istanbul' else '' }}>
                            Ä°stanbul (GMT+3)
                        </option>
                    </optgroup>
                    
                    <!-- Amerika BirleÅŸik Devletleri -->
                    <optgroup label="ðŸ‡ºðŸ‡¸ Amerika BirleÅŸik Devletleri">
                        <option value="America/New_York" {{ 'selected' if settings and settings.timezone == 'America/New_York' else '' }}>
                            New York (EST/EDT)
                        </option>
                        <option value="America/Chicago" {{ 'selected' if settings and settings.timezone == 'America/Chicago' else '' }}>
                            Chicago (CST/CDT)
                        </option>
                        <option value="America/Denver" {{ 'selected' if settings and settings.timezone == 'America/Denver' else '' }}>
                            Denver (MST/MDT)
                        </option>
                        <option value="America/Los_Angeles" {{ 'selected' if settings and settings.timezone == 'America/Los_Angeles' else '' }}>
                            Los Angeles (PST/PDT)
                        </option>
                    </optgroup>
                    
                    <!-- BirleÅŸik KrallÄ±k -->
                    <optgroup label="ðŸ‡¬ðŸ‡§ BirleÅŸik KrallÄ±k">
                        <option value="Europe/London" {{ 'selected' if settings and settings.timezone == 'Europe/London' else '' }}>
                            London (GMT/BST)
                        </option>
                    </optgroup>
                    
                    <!-- Almanya -->
                    <optgroup label="ðŸ‡©ðŸ‡ª Almanya">
                        <option value="Europe/Berlin" {{ 'selected' if settings and settings.timezone == 'Europe/Berlin' else '' }}>
                            Berlin (CET/CEST)
                        </option>
                        <option value="Europe/Munich" {{ 'selected' if settings and settings.timezone == 'Europe/Munich' else '' }}>
                            MÃ¼nih (CET/CEST)
                        </option>
                    </optgroup>
                    
                    <!-- Fransa -->
                    <optgroup label="ðŸ‡«ðŸ‡· Fransa">
                        <option value="Europe/Paris" {{ 'selected' if settings and settings.timezone == 'Europe/Paris' else '' }}>
                            Paris (CET/CEST)
                        </option>
                    </optgroup>
                    
                    <!-- Rusya -->
                    <optgroup label="ðŸ‡·ðŸ‡º Rusya">
                        <option value="Europe/Moscow" {{ 'selected' if settings and settings.timezone == 'Europe/Moscow' else '' }}>
                            Moskova (MSK)
                        </option>
                        <option value="Asia/Yekaterinburg" {{ 'selected' if settings and settings.timezone == 'Asia/Yekaterinburg' else '' }}>
                            Yekaterinburg (YEKT)
                        </option>
                        <option value="Asia/Novosibirsk" {{ 'selected' if settings and settings.timezone == 'Asia/Novosibirsk' else '' }}>
                            Novosibirsk (NOVT)
                        </option>
                    </optgroup>
                    
                    <!-- Ã‡in -->
                    <optgroup label="ðŸ‡¨ðŸ‡³ Ã‡in">
                        <option value="Asia/Shanghai" {{ 'selected' if settings and settings.timezone == 'Asia/Shanghai' else '' }}>
                            Åžanghay (CST)
                        </option>
                        <option value="Asia/Beijing" {{ 'selected' if settings and settings.timezone == 'Asia/Beijing' else '' }}>
                            Pekin (CST)
                        </option>
                    </optgroup>
                    
                    <!-- Japonya -->
                    <optgroup label="ðŸ‡¯ðŸ‡µ Japonya">
                        <option value="Asia/Tokyo" {{ 'selected' if settings and settings.timezone == 'Asia/Tokyo' else '' }}>
                            Tokyo (JST)
                        </option>
                        <option value="Asia/Osaka" {{ 'selected' if settings and settings.timezone == 'Asia/Osaka' else '' }}>
                            Osaka (JST)
                        </option>
                    </optgroup>
                    
                    <!-- Avustralya -->
                    <optgroup label="ðŸ‡¦ðŸ‡º Avustralya">
                        <option value="Australia/Sydney" {{ 'selected' if settings and settings.timezone == 'Australia/Sydney' else '' }}>
                            Sydney (AEDT/AEST)
                        </option>
                        <option value="Australia/Melbourne" {{ 'selected' if settings and settings.timezone == 'Australia/Melbourne' else '' }}>
                            Melbourne (AEDT/AEST)
                        </option>
                        <option value="Australia/Perth" {{ 'selected' if settings and settings.timezone == 'Australia/Perth' else '' }}>
                            Perth (AWST)
                        </option>
                    </optgroup>
                    
                    <!-- Hindistan -->
                    <optgroup label="ðŸ‡®ðŸ‡³ Hindistan">
                        <option value="Asia/Kolkata" {{ 'selected' if settings and settings.timezone == 'Asia/Kolkata' else '' }}>
                            Kolkata (IST)
                        </option>
                        <option value="Asia/Mumbai" {{ 'selected' if settings and settings.timezone == 'Asia/Mumbai' else '' }}>
                            Mumbai (IST)
                        </option>
                        <option value="Asia/Delhi" {{ 'selected' if settings and settings.timezone == 'Asia/Delhi' else '' }}>
                            Delhi (IST)
                        </option>
                    </optgroup>
                    
                    <!-- Kanada -->
                    <optgroup label="ðŸ‡¨ðŸ‡¦ Kanada">
                        <option value="America/Toronto" {{ 'selected' if settings and settings.timezone == 'America/Toronto' else '' }}>
                            Toronto (EST/EDT)
                        </option>
                        <option value="America/Vancouver" {{ 'selected' if settings and settings.timezone == 'America/Vancouver' else '' }}>
                            Vancouver (PST/PDT)
                        </option>
                        <option value="America/Montreal" {{ 'selected' if settings and settings.timezone == 'America/Montreal' else '' }}>
                            Montreal (EST/EDT)
                        </option>
                    </optgroup>
                    
                    <!-- Brezilya -->
                    <optgroup label="ðŸ‡§ðŸ‡· Brezilya">
                        <option value="America/Sao_Paulo" {{ 'selected' if settings and settings.timezone == 'America/Sao_Paulo' else '' }}>
                            SÃ£o Paulo (BRT/BRST)
                        </option>
                        <option value="America/Rio_de_Janeiro" {{ 'selected' if settings and settings.timezone == 'America/Rio_de_Janeiro' else '' }}>
                            Rio de Janeiro (BRT/BRST)
                        </option>
                    </optgroup>
                    
                    <!-- GÃ¼ney Afrika -->
                    <optgroup label="ðŸ‡¿ðŸ‡¦ GÃ¼ney Afrika">
                        <option value="Africa/Johannesburg" {{ 'selected' if settings and settings.timezone == 'Africa/Johannesburg' else '' }}>
                            Johannesburg (SAST)
                        </option>
                        <option value="Africa/Cape_Town" {{ 'selected' if settings and settings.timezone == 'Africa/Cape_Town' else '' }}>
                            Cape Town (SAST)
                        </option>
                    </optgroup>
                    
                    <!-- MÄ±sÄ±r -->
                    <optgroup label="ðŸ‡ªðŸ‡¬ MÄ±sÄ±r">
                        <option value="Africa/Cairo" {{ 'selected' if settings and settings.timezone == 'Africa/Cairo' else '' }}>
                            Kahire (EET/EEST)
                        </option>
                    </optgroup>
                    
                    <!-- BirleÅŸik Arap Emirlikleri -->
                    <optgroup label="ðŸ‡¦ðŸ‡ª BirleÅŸik Arap Emirlikleri">
                        <option value="Asia/Dubai" {{ 'selected' if settings and settings.timezone == 'Asia/Dubai' else '' }}>
                            Dubai (GST)
                        </option>
                        <option value="Asia/Abu_Dhabi" {{ 'selected' if settings and settings.timezone == 'Asia/Abu_Dhabi' else '' }}>
                            Abu Dhabi (GST)
                        </option>
                    </optgroup>
                </select>
                <p class="text-sm text-brown-600 mt-2">Site genelinde kullanÄ±lacak saat dilimini seÃ§in. TÃ¼m tarih ve saat bilgileri bu saat dilimine gÃ¶re gÃ¶sterilecektir.</p>
                
                <div id="timezone-preview" class="mt-3 p-3 bg-cream-50 border border-cream-200 rounded-lg hidden">
                    <div class="flex items-center text-sm text-brown-700">
                        <i data-lucide="info" class="w-4 h-4 mr-2"></i>
                        <span>Åžu anki zaman: <span id="current-time" class="font-medium"></span></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Yorum AyarlarÄ± -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-lg font-semibold text-brown-900 mb-4 flex items-center">
                <i data-lucide="message-circle" class="w-5 h-5 mr-2"></i>
                Yorum AyarlarÄ±
            </h3>
            
            <div>
                <label class="block text-brown-700 font-medium mb-2">Yorum Karakter SÄ±nÄ±rÄ±</label>
                <select name="comment_limit" 
                        class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                    <option value="125" {{ 'selected' if settings and settings.comment_limit == 125 else '' }}>125 karakter</option>
                    <option value="250" {{ 'selected' if settings and settings.comment_limit == 250 else '' }}>250 karakter</option>
                    <option value="500" {{ 'selected' if settings and settings.comment_limit == 500 else '' }}>500 karakter</option>
                    <option value="750" {{ 'selected' if settings and settings.comment_limit == 750 else '' }}>750 karakter</option>
                    <option value="1000" {{ 'selected' if settings and settings.comment_limit == 1000 else '' }}>1000 karakter</option>
                </select>
                <p class="text-sm text-brown-600 mt-1">KullanÄ±cÄ±larÄ±n yazabileceÄŸi maksimum yorum uzunluÄŸu</p>
            </div>
        </div>

        <div class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
            <div class="flex items-center">
                <i data-lucide="info" class="w-5 h-5 text-blue-600 mr-2"></i>
                <div>
                    <p class="text-blue-800 font-medium">Footer AyarlarÄ±</p>
                    <p class="text-blue-700 text-sm mt-1">
                        Footer ayarlarÄ±nÄ± yapmak iÃ§in 
                        <a href="/admin/customize" class="font-medium underline hover:no-underline">Site Ã–zelleÅŸtirme</a> 
                        sayfasÄ±nÄ± kullanÄ±n.
                    </p>
                </div>
            </div>
        </div>





        <!-- AI AyarlarÄ± -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-lg font-semibold text-brown-900 mb-4 flex items-center">
                <i data-lucide="brain" class="w-5 h-5 mr-2"></i>
                AI Ä°Ã§erik Ãœretimi AyarlarÄ±
            </h3>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-brown-700 font-medium mb-2">AI Prompt</label>
                    <textarea name="ai_prompt" rows="4" 
                              placeholder="AI'Ä±n iÃ§erik Ã¼retirken kullanacaÄŸÄ± temel talimat"
                              class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">{{ settings.ai_prompt if settings else 'TÃ¼rkÃ§e blog yazÄ±sÄ± yaz. SEO dostu, bilgilendirici ve okuyucu dostu olsun.' }}</textarea>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-brown-700 font-medium mb-2">VarsayÄ±lan Ä°Ã§erik UzunluÄŸu</label>
                        <select name="ai_content_length" 
                                class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                            <option value="short" {{ 'selected' if settings and settings.ai_content_length == 'short' else '' }}>KÄ±sa (300-500 kelime)</option>
                            <option value="medium" {{ 'selected' if settings and settings.ai_content_length == 'medium' else '' }}>Orta (700-1000 kelime)</option>
                            <option value="long" {{ 'selected' if settings and settings.ai_content_length == 'long' else '' }}>Uzun (1200-1800 kelime)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-brown-700 font-medium mb-2">VarsayÄ±lan Ä°Ã§erik TÃ¼rÃ¼</label>
                        <select name="ai_content_type" 
                                class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                            <option value="informative" {{ 'selected' if settings and settings.ai_content_type == 'informative' else '' }}>Bilgilendirici</option>
                            <option value="tutorial" {{ 'selected' if settings and settings.ai_content_type == 'tutorial' else '' }}>Rehber</option>
                            <option value="opinion" {{ 'selected' if settings and settings.ai_content_type == 'opinion' else '' }}>GÃ¶rÃ¼ÅŸ</option>
                            <option value="news" {{ 'selected' if settings and settings.ai_content_type == 'news' else '' }}>Haber</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Avatar Galerisi -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-lg font-semibold text-brown-900 mb-4 flex items-center">
                <i data-lucide="users" class="w-5 h-5 mr-2"></i>
                Profil Resmi Galerisi
            </h3>
            
            <div class="grid grid-cols-3 md:grid-cols-6 gap-4 mb-4">
                {% for avatar in avatars %}
                <div class="relative group">
                    <img src="{{ avatar.url }}" alt="Avatar" class="w-16 h-16 rounded-full border-2 border-cream-300 hover:border-brown-500 transition-smooth">
                    <button onclick="deleteAvatar({{ avatar.id }})" 
                            class="absolute -top-2 -right-2 w-6 h-6 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-smooth flex items-center justify-center">
                        <i data-lucide="x" class="w-3 h-3"></i>
                    </button>
                </div>
                {% endfor %}
            </div>
            
            <div class="border-t border-cream-200 pt-4">
                <h4 class="font-medium text-brown-900 mb-2">Yeni Avatar Ekle</h4>
                <div class="flex space-x-4">
                    <input type="file" name="avatar_file" accept="image/*" 
                           class="flex-1 px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                    <input type="url" name="avatar_url" placeholder="veya URL girin" 
                           class="flex-1 px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                </div>
            </div>
        </div>

        <!-- Kaydet Butonu -->
        <div class="flex justify-end">
            <button type="submit" class="bg-brown-600 text-white px-6 py-3 rounded-lg hover:bg-brown-700 transition-smooth">
                <i data-lucide="save" class="w-4 h-4 inline mr-2"></i>
                AyarlarÄ± Kaydet
            </button>
        </div>
    </div>
</form>
{% endblock %}

{% block extra_js %}
<script>
// Logo type selection handler
document.addEventListener('DOMContentLoaded', function() {
    const logoTypeRadios = document.querySelectorAll('input[name="logo_type"]');
    const logoIconField = document.getElementById('logo-icon-field');
    const logoImageField = document.getElementById('logo-image-field');
    
    function toggleLogoFields() {
        const selectedType = document.querySelector('input[name="logo_type"]:checked').value;
        
        logoIconField.classList.add('hidden');
        logoImageField.classList.add('hidden');
        
        if (selectedType === 'icon' || selectedType === 'icon_text') {
            logoIconField.classList.remove('hidden');
        }
        
        if (selectedType === 'image' || selectedType === 'icon_text') {
            logoImageField.classList.remove('hidden');
        }
    }
    
    logoTypeRadios.forEach(radio => {
        radio.addEventListener('change', toggleLogoFields);
    });
    
    toggleLogoFields();
});

async function deleteAvatar(avatarId) {
    if (confirm('Bu avatarÄ± silmek istediÄŸinizden emin misiniz?')) {
        try {
            const response = await fetch(`/admin/avatars/${avatarId}/delete`, {
                method: 'DELETE'
            });
            if (response.ok) {
                location.reload();
            } else {
                alert('Avatar silinirken bir hata oluÅŸtu.');
            }
        } catch (error) {
            console.error('Avatar silme hatasÄ±:', error);
            alert('Avatar silinirken bir hata oluÅŸtu.');
        }
    }
}

// Media gallery modal
let mediaGalleryModal = null;
let mediaGalleryTarget = null;

function openMediaGallery(target) {
    mediaGalleryTarget = target;
    
    if (!mediaGalleryModal) {
        createMediaGalleryModal();
    }
    
    loadMediaFiles();
    mediaGalleryModal.classList.remove('hidden');
}

function createMediaGalleryModal() {
    const modalHtml = `
        <div id="media-gallery-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
            <div class="bg-white rounded-xl p-6 max-w-4xl max-h-[80vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold">Medya Galerisi</h3>
                    <button onclick="closeMediaGallery()" class="text-gray-500 hover:text-gray-700">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
                <div id="media-grid" class="grid grid-cols-4 gap-4">
                    <!-- Media files will be loaded here -->
                </div>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', modalHtml);
    mediaGalleryModal = document.getElementById('media-gallery-modal');
}

function closeMediaGallery() {
    if (mediaGalleryModal) {
        mediaGalleryModal.classList.add('hidden');
    }
}

async function loadMediaFiles() {
    try {
        const response = await fetch('/admin/api/media');
        const data = await response.json();
        
        const mediaGrid = document.getElementById('media-grid');
        mediaGrid.innerHTML = '';
        
        data.media.forEach(media => {
            const mediaItem = document.createElement('div');
            mediaItem.className = 'cursor-pointer border-2 border-transparent hover:border-brown-500 rounded-lg overflow-hidden';
            mediaItem.onclick = () => selectMedia(media.file_path);
            
            if (media.mime_type.startsWith('image/')) {
                mediaItem.innerHTML = `
                    <img src="${media.file_path}" alt="${media.alt_text || media.original_name}" 
                         class="w-full h-24 object-cover">
                    <p class="p-2 text-xs text-gray-600 truncate">${media.original_name}</p>
                `;
            } else {
                mediaItem.innerHTML = `
                    <div class="w-full h-24 bg-gray-200 flex items-center justify-center">
                        <i data-lucide="file" class="w-8 h-8 text-gray-500"></i>
                    </div>
                    <p class="p-2 text-xs text-gray-600 truncate">${media.original_name}</p>
                `;
            }
            
            mediaGrid.appendChild(mediaItem);
        });
        
        // Reinitialize Lucide icons
        lucide.createIcons();
    } catch (error) {
        console.error('Media yÃ¼klenirken hata:', error);
    }
}

function selectMedia(filePath) {
    if (mediaGalleryTarget === 'logo') {
        document.querySelector('input[name="site_logo"]').value = filePath;
    }
    
    closeMediaGallery();
}

// Timezone preview functionality
document.addEventListener('DOMContentLoaded', function() {
    const timezoneSelect = document.getElementById('timezone-select');
    const timezonePreview = document.getElementById('timezone-preview');
    const currentTimeSpan = document.getElementById('current-time');

    if (timezoneSelect) {
        // Show preview on page load if timezone is already selected
        if (timezoneSelect.value) {
            showTimezonePreview(timezoneSelect.value);
        }

        // Show preview when timezone changes
        timezoneSelect.addEventListener('change', function() {
            const selectedTimezone = this.value;
            if (selectedTimezone) {
                showTimezonePreview(selectedTimezone);
            } else {
                timezonePreview.classList.add('hidden');
            }
        });
    }

    function showTimezonePreview(timezone) {
        try {
            const now = new Date();
            const timeInTimezone = now.toLocaleString('tr-TR', { 
                timeZone: timezone,
                year: 'numeric',
                month: '2-digit', 
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            
            currentTimeSpan.textContent = timeInTimezone;
            timezonePreview.classList.remove('hidden');
            
            // Update time every second
            setInterval(function() {
                const now = new Date();
                const timeInTimezone = now.toLocaleString('tr-TR', { 
                    timeZone: timezone,
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit', 
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                currentTimeSpan.textContent = timeInTimezone;
            }, 1000);
            
        } catch (error) {
            console.error('Timezone preview error:', error);
            currentTimeSpan.textContent = 'Zaman bilgisi alÄ±namadÄ±';
            timezonePreview.classList.remove('hidden');
        }
    }
});
</script>
{% endblock %}