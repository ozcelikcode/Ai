{% extends "admin/base.html" %}

{% block page_title %}Site Ayarları{% endblock %}
{% block page_description %}Sitenizin genel ayarlarını yönetin{% endblock %}

{% block content %}
<form method="POST" action="/admin/settings/save" enctype="multipart/form-data">
    <div class="space-y-8">
        <!-- Site Genel Ayarları -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-lg font-semibold text-brown-900 mb-4 flex items-center">
                <i data-lucide="globe" class="w-5 h-5 mr-2"></i>
                Site Genel Ayarları
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-brown-700 font-medium mb-2">Site Başlığı</label>
                    <input type="text" name="site_title" 
                           value="{{ settings.site_title if settings else 'AI Blog' }}" 
                           class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                </div>
                
                <div>
                    <label class="block text-brown-700 font-medium mb-2">Site Logo URL</label>
                    <input type="url" name="site_logo" 
                           value="{{ settings.site_logo if settings else '' }}" 
                           placeholder="https://example.com/logo.png"
                           class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                </div>
            </div>
            
            <div class="mt-4">
                <label class="block text-brown-700 font-medium mb-2">Site Açıklaması</label>
                <textarea name="meta_description" rows="3" 
                          placeholder="Sitenizin kısa açıklaması"
                          class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">{{ settings.meta_description if settings else '' }}</textarea>
            </div>
            
            <div class="mt-4">
                <label class="block text-brown-700 font-medium mb-2">Anahtar Kelimeler</label>
                <input type="text" name="meta_keywords" 
                       value="{{ settings.meta_keywords if settings else '' }}" 
                       placeholder="blog, yapay zeka, teknoloji"
                       class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                <p class="text-sm text-brown-600 mt-1">Virgülle ayırarak yazın</p>
            </div>
            
            <div class="mt-4">
                <label class="block text-brown-700 font-medium mb-2">Favicon URL</label>
                <input type="url" name="favicon" 
                       value="{{ settings.favicon if settings else '' }}" 
                       placeholder="https://example.com/favicon.ico"
                       class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
            </div>
        </div>

        <!-- AI Ayarları -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-lg font-semibold text-brown-900 mb-4 flex items-center">
                <i data-lucide="brain" class="w-5 h-5 mr-2"></i>
                AI İçerik Üretimi Ayarları
            </h3>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-brown-700 font-medium mb-2">AI Prompt</label>
                    <textarea name="ai_prompt" rows="4" 
                              placeholder="AI'ın içerik üretirken kullanacağı temel talimat"
                              class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">{{ settings.ai_prompt if settings else 'Türkçe blog yazısı yaz. SEO dostu, bilgilendirici ve okuyucu dostu olsun.' }}</textarea>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-brown-700 font-medium mb-2">Varsayılan İçerik Uzunluğu</label>
                        <select name="ai_content_length" 
                                class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                            <option value="short" {{ 'selected' if settings and settings.ai_content_length == 'short' else '' }}>Kısa (300-500 kelime)</option>
                            <option value="medium" {{ 'selected' if settings and settings.ai_content_length == 'medium' else '' }}>Orta (700-1000 kelime)</option>
                            <option value="long" {{ 'selected' if settings and settings.ai_content_length == 'long' else '' }}>Uzun (1200-1800 kelime)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-brown-700 font-medium mb-2">Varsayılan İçerik Türü</label>
                        <select name="ai_content_type" 
                                class="w-full px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                            <option value="informative" {{ 'selected' if settings and settings.ai_content_type == 'informative' else '' }}>Bilgilendirici</option>
                            <option value="tutorial" {{ 'selected' if settings and settings.ai_content_type == 'tutorial' else '' }}>Rehber</option>
                            <option value="opinion" {{ 'selected' if settings and settings.ai_content_type == 'opinion' else '' }}>Görüş</option>
                            <option value="news" {{ 'selected' if settings and settings.ai_content_type == 'news' else '' }}>Haber</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Avatar Galerisi -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h3 class="text-lg font-semibold text-brown-900 mb-4 flex items-center">
                <i data-lucide="users" class="w-5 h-5 mr-2"></i>
                Profil Resmi Galerisi
            </h3>
            
            <div class="grid grid-cols-3 md:grid-cols-6 gap-4 mb-4">
                {% for avatar in avatars %}
                <div class="relative group">
                    <img src="{{ avatar.url }}" alt="Avatar" class="w-16 h-16 rounded-full border-2 border-cream-300 hover:border-brown-500 transition-smooth">
                    <button onclick="deleteAvatar({{ avatar.id }})" 
                            class="absolute -top-2 -right-2 w-6 h-6 bg-red-600 text-white rounded-full opacity-0 group-hover:opacity-100 transition-smooth flex items-center justify-center">
                        <i data-lucide="x" class="w-3 h-3"></i>
                    </button>
                </div>
                {% endfor %}
            </div>
            
            <div class="border-t border-cream-200 pt-4">
                <h4 class="font-medium text-brown-900 mb-2">Yeni Avatar Ekle</h4>
                <div class="flex space-x-4">
                    <input type="file" name="avatar_file" accept="image/*" 
                           class="flex-1 px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                    <input type="url" name="avatar_url" placeholder="veya URL girin" 
                           class="flex-1 px-3 py-2 border border-cream-300 rounded-lg focus:ring-2 focus:ring-brown-500 focus:border-transparent">
                </div>
            </div>
        </div>

        <!-- Kaydet Butonu -->
        <div class="flex justify-end">
            <button type="submit" class="bg-brown-600 text-white px-6 py-3 rounded-lg hover:bg-brown-700 transition-smooth">
                <i data-lucide="save" class="w-4 h-4 inline mr-2"></i>
                Ayarları Kaydet
            </button>
        </div>
    </div>
</form>
{% endblock %}

{% block extra_js %}
<script>
async function deleteAvatar(avatarId) {
    if (confirm('Bu avatarı silmek istediğinizden emin misiniz?')) {
        try {
            const response = await fetch(`/admin/avatars/${avatarId}/delete`, {
                method: 'DELETE'
            });
            if (response.ok) {
                location.reload();
            } else {
                alert('Avatar silinirken bir hata oluştu.');
            }
        } catch (error) {
            console.error('Avatar silme hatası:', error);
            alert('Avatar silinirken bir hata oluştu.');
        }
    }
}
</script>
{% endblock %}